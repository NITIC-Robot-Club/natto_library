<launch>
    <arg name="chassis_type" default="swerve"/>
    <arg name="simulation_param_path" default=""/>
    <arg name="chassis_param_path" default=""/>
    <arg name="lidar_param_path" default=""/>

    <!-- シミュレーションコンテナー -->
    <node_container pkg="rclcpp_components" exec="component_container" name="simulation_container" namespace="/simulation">
        <composable_node pkg="natto_simple_simulation" plugin="$(var chassis_type)_simulator::$(var chassis_type)_simulator" name="chassis_simulator" namespace="/simulation">
            <param from="$(var chassis_param_path)"/>
            <param from="$(var simulation_param_path)"/>
            <remap from="$(var chassis_type)_command" to="/$(var chassis_type)/command"/>
            <remap from="$(var chassis_type)_result" to="/$(var chassis_type)/result"/>
            <remap from="simulation_pose" to="/simulation/pose"/>
        </composable_node>

        <composable_node pkg="natto_simple_simulation" plugin="imu_simulator::imu_simulator" name="imu_simulator" namespace="/simulation">
            <param from="$(var simulation_param_path)"/>
            <remap from="simulation_pose" to="/simulation/pose"/>
            <remap from="imu" to="/sensing/imu/data_raw"/>
            <remap from="simulation_pose" to="/simulation/pose"/>
            <param name="frequency" value="30.0"/>
        </composable_node>
    </node_container>

    <!-- LiDARシミュレーター -->
    <include file="$(find-pkg-share natto_launch)/launch/components/lidar_simulation.launch.py">
        <arg name="lidar_param_path" value="$(var lidar_param_path)"/>
    </include>
</launch>