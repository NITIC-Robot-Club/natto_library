<launch>
    <node_container pkg="rclcpp_components" exec="component_container" name="common_container" namespace="/behavior">
        <composable_node pkg="natto_state_machine" plugin="mermaid_loader::mermaid_loader" name="mermaid_loader" namespace="/behavior">
            <param name="mermaid_path" value="$(var state_graph_path)"/>
        </composable_node>

        <composable_node pkg="natto_state_machine" plugin="state_machine::state_machine" name="state_machine" namespace="/behavior">
            <param name="state_timeout_sec" value="$(var state_timeout_sec)"/>
        </composable_node>

        <composable_node pkg="natto_state_machine" plugin="default_action::default_action" name="default_action" namespace="/behavior">
            <remap from="goal_pose" to="/goal_pose"/>
            <remap from="goal_reached" to="/control/goal_reached"/>
            <remap from="current_pose" to="/localization/current_pose"/>
            <remap from="joint_states" to="/joint_states"/>
            <remap from="allow_auto_drive" to="/controller/allow_auto_drive"/>
            <param name="initial_allow_auto_drive" value="$(var initial_allow_auto_drive)"/>
            <param from="$(var joint_rule_path)"/>
        </composable_node>
    </node_container>
</launch>