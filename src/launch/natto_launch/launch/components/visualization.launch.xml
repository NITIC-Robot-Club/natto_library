<launch>
    <arg name="chassis_type" default=""/>
    <arg name="chassis_param_path" default=""/>
    <arg name="rviz_path" default=""/>
    <arg name="use_dark_rviz" default="true"/>
    <arg name="fps" default="100.0"/>

    <!-- 表示コンテナ -->
    <node_container pkg="rclcpp_components" exec="component_container" name="visualization_container" namespace="visualization">
        <!-- マップ表示 -->
        <composable_node pkg="natto_visualization_converter" plugin="map_visualizer::map_visualizer" name="map" namespace="visualization">
            <param name="frequency" value="$(var fps)"/>
            <remap from="map" to="/common/map"/>
            <remap from="marker_array" to="/visualization/map"/>
        </composable_node>

        <!-- 足回りコマンド -->
        <!-- <composable_node pkg="natto_visualization_converter" plugin="$(var chassis_type)_visualizer::$(var chassis_type)_visualizer" name="command" namespace="visualization/$(var chassis_type)">
            <param name="arrow_r" value="0.0"/>
            <param name="arrow_g" value="0.0"/>
            <param name="arrow_b" value="1.0"/>
            <param name="frequency" value="$(var fps)"/>
            <param from="$(var chassis_param_path)"/>
            <remap from="$(var chassis_type)" to="/$(var chassis_type)/command"/>
            <remap from="marker_array" to="/visualization/chassis/command"/>
        </composable_node> -->

        <!-- 足回り結果 -->
        <!-- <composable_node pkg="natto_visualization_converter" plugin="$(var chassis_type)_visualizer::$(var chassis_type)_visualizer" name="result" namespace="visualization/$(var chassis_type)">
            <param name="frequency" value="$(var fps)"/>
            <param name="arrow_r" value="1.0"/>
            <param name="arrow_g" value="0.0"/>
            <param name="arrow_b" value="0.0"/>
            <param from="$(var chassis_param_path)"/>
            <remap from="$(var chassis_type)" to="/$(var chassis_type)/result"/>
            <remap from="marker_array" to="/visualization/chassis/result"/>
        </composable_node> -->

        <!-- 直線表示 -->
        <composable_node pkg="natto_visualization_converter" plugin="line_visualizer::line_visualizer" name="lines" namespace="visualization/lines">
            <param name="frequency" value="$(var fps)"/>
            <remap from="lines" to="/sensing/lidar/lines"/>
            <remap from="marker_array" to="/visualization/lines"/>
            <param name="frame_id" value="base_link"/>
        </composable_node>

        <!-- 線分表示 -->
        <composable_node pkg="natto_visualization_converter" plugin="line_segments_visualizer::line_segments_visualizer" name="line_segments" namespace="visualization/line_segments">
            <param name="frequency" value="$(var fps)"/>
            <remap from="line_segments" to="/sensing/lidar/line_segments"/>
            <remap from="marker_array" to="/visualization/line_segments"/>
            <param name="frame_id" value="base_link"/>
        </composable_node>
    </node_container>

    <node pkg="rviz2" exec="rviz2" name="rviz2" output="screen"
        args="-d $(var rviz_path) --stylesheet $(find-pkg-share natto_launch)/rviz/dark.qss" if="$(var use_dark_rviz)"/>

    <node pkg="rviz2" exec="rviz2" name="rviz2" output="screen"
        args="-d $(var rviz_path)" unless="$(var use_dark_rviz)"/>

    
</launch>