<launch>
    <arg name="chassis_type" default="swerve"/>
    <arg name="initial_pose_x" default="1.0"/>
    <arg name="initial_pose_y" default="1.0"/>
    <arg name="initial_pose_yaw_deg" default="0.0"/>
    <arg name="chassis_param_path" default=""/>
    <arg name="lidar_param_path" default=""/>

    <!-- シミュレーションコンテナー -->
    <node_container pkg="rclcpp_components" exec="component_container" name="simulation_container" namespace="/simulation">
        <composable_node pkg="natto_simple_simulation" plugin="$(var chassis_type)_simulator::$(var chassis_type)_simulator" name="chassis_simulator" namespace="/simulation">
            <param from="$(var chassis_param_path)"/>
            <param name="initial_pose_x" value="$(var initial_pose_x)"/>
            <param name="initial_pose_y" value="$(var initial_pose_y)"/>
            <param name="initial_pose_yaw_deg" value="$(var initial_pose_yaw_deg)"/>
            <remap from="$(var chassis_type)_command" to="/$(var chassis_type)/command"/>
            <remap from="$(var chassis_type)_result" to="/$(var chassis_type)/result"/>
            <remap from="simulation_pose" to="/simulation/pose"/>
        </composable_node>
    </node_container>

    <!-- LiDARシミュレーター -->
    <include file="$(find-pkg-share natto_launch)/launch/lidar_simulation.launch.py">
        <arg name="lidar_param_path" value="$(var lidar_param_path)"/>
    </include>
</launch>